# Credential Scanner (CredScan) in the Build

This repository uses the so called [CredScan created by Microsoft](https://secdevtools.azurewebsites.net/helpcredscan.html#collapseOne) to prevent passwords being added to the master branch.

To not even commit credentials to the repository you can download and install a [Visual Studio extension](https://marketplace.visualstudio.com/items?itemName=VSIDEDevOpsMSFT.ContinuousDeliveryToolsforVisualStudio&ssr=false#overview). Unfortunately, no VS Code extension is available yet.

## Unit tests

When writing unit tests passwords have to sometimes used. Of course only fake passwords should be used.
To prevent CredScan to mix up fake passwords with real ones, a suppression file is used.

There are several passwords defined, that can be used:

1. 12345
2. 678910
3. 00000000-0000-0000-0000-000000000000

Please stick to those passwords if you have to use some. The GUID styled password can also be used for fake thumbprints.

If you need to add a new password, please write an issue first.

## How suppressions work

The following documentation is taken from [the official CredScan](https://secdevtools.azurewebsites.net/helpcredscan.html) page.

### Suppress all occurrences of a given secret within the specified path

The hash key of the secret from the CredScan output file is required as shown in the sample below

```json
        {
            "tool": "Credential Scanner",
            "suppressions": [
            {
                "hash": "CLgYxl2FcQE8XZgha9/UbKLTkJkUh3Vakkxh2CAdhtY=",
                "_justification": "Secret used by MSDN sample, it is fake."
            }
          ]
        }
```

Warning: The hash key is generated by a portion of the matching value or file content. Any source code revision could change the hash key and disable the suppression rule.

### To suppress all secrets in a specified file (or to suppress the secrets file itself)

The file expression could be a file name or any postfix portion of the full file path/name. Wildcards are not supported.

#### Example

File to be suppressed: [InputPath]\src\JS\lib\angular.js 
Valid Suppression Rules:

* [InputPath]\src\JS\lib\angular.js -- suppress the file in the specified path
* \src\JS\lib\angular.js
* \JS\lib\angular.js
* \lib\angular.js
* angular.js -- suppress any file with the same name

```json
        {
            "tool": "Credential Scanner",
            "suppressions": [
            {
                "file": "\\files\\AdditonalSearcher.xml", 
                "_justification": "Additional CredScan searcher specific to my team"
            },
            {
                "file": "\\files\\unittest.pfx", 
                "_justification": "Legitimate UT certificate file with private key"
            }
          ]
        }
```

**Warning:** All future secrets added to the file will also get suppressed automatically.
